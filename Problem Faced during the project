üêû Issue: MongoDB Connection Fails with querySrv ENOTFOUND
üìå Problem Description

While running the Node.js backend server, the application failed to connect to MongoDB Atlas and crashed with the following error:

Error: querySrv ENOTFOUND _mongodb._tcp.playknow.yg0rt.mongodb.net


Even though the server started successfully, the database connection could not be established.

üîç Root Cause Analysis

At first glance, the issue appeared to be related to:

Node.js version

Mongoose / MongoDB driver compatibility

However, further investigation revealed that the error occurred before the MongoDB driver was executed, during DNS resolution.

The actual root cause was:

The MongoDB Atlas cluster had been automatically paused due to prolonged inactivity.

When a free/shared MongoDB Atlas cluster is paused:

The database servers are stopped

MongoDB Atlas removes the SRV DNS record associated with the cluster

Any application trying to resolve the cluster hostname fails with a DNS error

üß† Why This Error Happens

The application was using an SRV-based connection string:

mongodb+srv://username:password@cluster.mongodb.net/dbname


This format relies on DNS SRV records to discover MongoDB nodes dynamically.

When the cluster is paused:

The SRV record (_mongodb._tcp.<cluster>.mongodb.net) no longer exists

DNS lookup fails

Node.js throws querySrv ENOTFOUND

This happens before Mongoose or MongoDB driver logic is executed.

‚úÖ Solution

Logged into MongoDB Atlas

Navigated to Database ‚Üí Clusters

Resumed the paused cluster

Waited for the cluster status to change to Running

Restarted the backend server

After resuming the cluster, the DNS SRV record became available again and the application connected successfully.

üÜï Technical Concepts Learned (Explained Separately)
1Ô∏è‚É£ SRV DNS Records

SRV (Service) records are a type of DNS record used to locate services, not just IP addresses.

MongoDB Atlas uses SRV records to:

Discover all replica set nodes automatically

Enable failover and scaling

Avoid hardcoding hostnames or ports

Example:

_mongodb._tcp.cluster0.abcde.mongodb.net


When using mongodb+srv://, the MongoDB driver first queries this DNS record.

2Ô∏è‚É£ Difference Between mongodb+srv:// and mongodb://
Connection Type	Description
mongodb+srv://	Uses SRV + TXT DNS records for automatic node discovery
mongodb://	Requires explicit hostnames and ports

SRV-based connections are more flexible but depend on DNS availability.

3Ô∏è‚É£ Effect of Paused MongoDB Atlas Clusters

When a MongoDB Atlas cluster is paused:

Database processes stop

SRV DNS records are removed

Any new connection attempt fails at DNS resolution

This behavior is common for free-tier clusters.

4Ô∏è‚É£ Error Classification by System Layer

This issue reinforced the importance of identifying where a failure occurs:

Layer	Example Error
DNS	ENOTFOUND
Network	ECONNREFUSED
Authentication	Authentication failed
Driver / App	MongoParseError

The error belonged to the DNS layer, not the application layer.

üéØ Key Takeaways

Not all connection errors are caused by code or version mismatches

Cloud-managed services can introduce operational behaviors (like auto-pausing)

Always isolate issues by layer: DNS ‚Üí Network ‚Üí Auth ‚Üí Application

Proper debugging avoids unnecessary dependency changes

üìå Preventive Measures

Always check MongoDB Atlas cluster status before starting the backend

Add startup logs to verify database connectivity

Document operational dependencies in project README
